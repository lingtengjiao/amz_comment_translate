# 数据透视AI Prompt标准化设计

## 一、设计原则

### 1.1 核心定位
**数据透视专注于交叉分析（2D/3D组合）推理决策**，AI解读需要：
- 从**交叉关系**中发现洞察（而非单维度描述）
- 识别**决策模式**和**业务机会**
- 提供**可执行的行动建议**

### 1.2 输出格式标准化
所有AI解读必须遵循统一的数据结构：

```typescript
interface Interpretation {
  keyFindings: string[];           // 关键发现（2-4条）
  dataSupport: string | Array<{    // 数据支撑
    metric: string;                 // 指标名称
    value: string;                  // 指标值
  }>;
  recommendations: string[];        // 行动建议（2-3条）
  severity: 'info' | 'success' | 'warning' | 'error' | 'critical';
}
```

### 1.3 Prompt设计原则
1. **明确数据上下文**：清晰说明输入数据的含义和结构
2. **强调交叉分析**：要求AI关注维度间的交叉关系，而非单维度统计
3. **业务导向**：要求输出可执行的商业洞察和建议
4. **数据驱动**：所有发现必须有具体数据支撑
5. **格式严格**：要求返回标准JSON格式

---

## 二、Prompt模板结构

### 2.1 基础模板

```python
BASE_PROMPT_TEMPLATE = """
你是一位专业的产品分析专家，擅长从用户评论的交叉分析中提炼商业洞察。

# 分析任务
{analysis_name} - {analysis_description}

# 业务价值
{business_value}

# 输入数据
{data_description}

# 数据内容
{data_json}

# 分析要求
1. **关键发现**（2-4条）：
   - 聚焦于{focus_dimension}的交叉关系洞察
   - 识别显著的决策模式、异常模式或业务机会
   - 每条发现必须包含具体数据（如"X次提及"、"占比Y%"、"出现Z次"）
   - 避免单维度统计，强调交叉关系的意义

2. **数据支撑**：
   - 提供关键数据指标（如"基于N条评论分析"、"共识别M种组合"）
   - 可以是一个字符串，也可以是多个指标数组

3. **行动建议**（2-3条）：
   - 基于交叉分析发现，提供可执行的商业建议
   - 建议要具体、可操作，避免泛泛而谈
   - 优先考虑对业务影响最大的建议

4. **严重程度判断**：
   - `info`: 一般信息性洞察
   - `success`: 发现积极机会或优势
   - `warning`: 需要关注的问题或风险
   - `error`: 严重问题需要立即处理
   - `critical`: 致命问题，可能影响产品生存

# 输出格式
请返回标准JSON格式，严格遵循以下结构：
{{
  "keyFindings": [
    "发现1（包含具体数据）",
    "发现2（包含具体数据）",
    "发现3（包含具体数据）"
  ],
  "dataSupport": "基于X条评论分析，共识别Y种组合" 或 [
    {{"metric": "指标1", "value": "数值1"}},
    {{"metric": "指标2", "value": "数值2"}}
  ],
  "recommendations": [
    "建议1（具体可执行）",
    "建议2（具体可执行）",
    "建议3（具体可执行）"
  ],
  "severity": "info|success|warning|error|critical"
}}

# 注意事项
- 必须返回有效的JSON格式
- 所有发现必须基于输入数据，不要编造
- 关键发现中必须包含具体数字
- 行动建议要具体可执行，避免空泛
"""
```

---

## 三、前端模块与后端AI解读完整映射

### 3.0 映射表总览

| 模块 | 前端标题 | AI解读类型 | Prompt配置 | 分析方法 | 数据来源 | 模块类型 |
|------|---------|-----------|-----------|---------|---------|---------|
| **1.0** | 人群分布概览 | - | - | - | aggregated_themes | 内联生成 |
| **1.1** | 决策链路分析 | `decision_flow` | ✅ | ✅ | theme_highlights | 2D |
| **1.2** | 人群-卖点匹配分析 | `audience_strength` | ✅ | ✅ | theme_highlights + insights | 2D |
| **1.3** | 决策逻辑链 | `decision_logic_chain` | ✅ | ✅ | theme_highlights | 3D |
| **2.0** | 动机分布概览 | - | - | - | aggregated_themes | 内联生成 |
| **2.1** | 刚需场景分析 | `motivation_location` | ✅ | ✅ | theme_highlights | 2D |
| **2.2** | 需求满足度矩阵 | `demand_satisfaction` | ✅ | ✅ | theme_highlights + reviews | 2D |
| **2.3** | 心智匹配分析 | `motivation_emotion` | ✅ | ✅ | theme_highlights + insights | 2D |
| **2.4** | 研发优先级 | `rnd_priority` | ✅ | ✅ | theme_highlights + insights | 3D |
| **3.0** | 维度分布概览 | - | - | - | aggregated_insights | 内联生成 |
| **3.1** | 致命缺陷识别 | `critical_weakness` | ✅ | ✅ | insights + reviews | 2D |
| **3.2** | 优劣势对比 | `strength_weakness` | ✅ | ✅ | insights | 2D |
| **3.3** | 优势情感分析 | `strength_emotion` | ✅ | ✅ | insights | 2D |
| **3.4** | 场景化改进建议 | `improvement_priority` | ✅ | ✅ | theme_highlights + insights | 2D |
| **3.5** | 动机分层优化 | `motivation_suggestion` | ✅ | ✅ | theme_highlights + insights | 2D |
| **3.6** | 维度冲突分析 | `negative_optimization` | ✅ | ✅ | insights | 2D |
| **4.0** | 场景要素分布 | - | - | - | aggregated_themes | 内联生成 |
| **4.1** | 地点×时间热力图 | `scenario_distribution` | ✅ | ✅ | theme_highlights | 2D |
| **4.2** | 场景×情感热力图 | `scenario_sentiment` | ✅ | ✅ | insights | 2D |
| **4.3** | 真实生活瞬间 | `life_moment` | ✅ | ✅ | theme_highlights + insights | 3D |
| **4.4** | 环境冲突分析 | `environment_conflict` | ✅ | ✅ | insights + theme_highlights | 3D |
| **5.0** | 情感分布概览 | - | - | - | aggregated_themes | 内联生成 |
| **5.1** | 品牌记忆点 | `brand_memory` | ✅ | ✅ | insights | 3D |
| **5.2** | 用户推荐意愿 | `recommendation_willingness` | ✅ | ✅ | reviews | 统计 |
| **5.3** | 品牌核心心智 | `brand_mind` | ✅ | ✅ | insights | 统计 |

**说明**:
- ✅ = 已完成实现
- 概览模块（1.0, 2.0, 3.0, 4.0, 5.0）使用前端内联生成，不需要后端AI解读
- 数据来源标注了使用的表：`theme_highlights` 或 `insights` 或 `reviews`

---

## 四、各子模块Prompt定制

### 4.1 人群洞察模块

#### 1.1 决策链路分析 (decision_flow)
**分析维度**：购买者 × 使用者（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "购买者与使用者的配对关系"
- `business_value`: "识别'买者非用者'场景，优化广告投放和文案话术"
- `data_description`: "购买者-使用者配对数据，包含每种配对的出现次数和占比"

**关键发现要求**：
- 识别主要的购买者-使用者配对模式
- 发现"购买者≠使用者"的错位场景（礼品/代购）
- 统计错位场景的占比和频次

**示例输出**：
```json
{
  "keyFindings": [
    "主要购买者: 宝妈 (24次提及)，主要使用者: 学龄前儿童 (29次提及)",
    "购买者≠使用者，存在礼品/代购场景，占比68.5%",
    "最频繁配对: 宝妈→学龄前儿童 (15次，占比22.1%)"
  ],
  "dataSupport": "基于53条评论分析，共识别6种购买者-使用者配对组合",
  "recommendations": [
    "针对主要人群定制营销素材：突出'宝妈为学龄前儿童选购'的场景",
    "优化礼品包装和赠送体验：针对礼品场景设计包装和文案"
  ],
  "severity": "info"
}
```

#### 1.2 人群-卖点匹配分析 (audience_strength)
**分析维度**：购买者 × 产品优势（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "不同购买者群体关注的产品优势差异"
- `business_value`: "识别不同人群最关注的优势点，用于广告素材定制"
- `data_description`: "购买者-产品优势交叉矩阵，显示每个购买者群体提及各优势的次数"

**关键发现要求**：
- 识别每个购买者群体最关注的优势维度
- 发现不同人群的优势偏好差异
- 识别"独占优势"（某人群特别关注而其他人群不关注）

**示例输出**：
```json
{
  "keyFindings": [
    "健身人群最关注'便携性'（12次提及，占比60%）",
    "办公人群最关注'静音'（8次提及，占比40%）",
    "不同人群优势偏好差异明显，需要差异化营销"
  ],
  "dataSupport": [
    {"metric": "购买者群体数", "value": "4个"},
    {"metric": "优势维度数", "value": "6个"},
    {"metric": "总提及次数", "value": "45次"}
  ],
  "recommendations": [
    "针对健身人群：广告素材突出便携性和运动场景",
    "针对办公人群：广告素材突出静音特性和办公场景",
    "创建人群-卖点匹配的广告素材库"
  ],
  "severity": "success"
}
```

#### 1.3 决策逻辑链 (decision_logic_chain)
**分析维度**：购买者 × 使用者 × 动机（3D交叉）

**Prompt定制点**：
- `focus_dimension`: "完整的购买决策路径（购买者→使用者→动机）"
- `business_value`: "完整还原购买决策路径，用于广告受众定位、识别礼品场景"
- `data_description`: "3D矩阵数据，按购买者分层，每层显示使用者×动机的热力图"

**关键发现要求**：
- 识别主要的决策路径（购买者→使用者→动机）
- 发现不同购买者群体的决策模式差异
- 识别高频决策路径和异常路径

**示例输出**：
```json
{
  "keyFindings": [
    "主要决策路径: 宝妈（购买者）→ 学龄前儿童（使用者）→ 安全需求（动机），出现18次",
    "礼品场景明显：68%的购买者是为他人购买，主要动机是'送礼'和'安全需求'",
    "不同购买者群体的决策模式差异显著，需要分层营销"
  ],
  "dataSupport": "基于53条评论分析，识别出5种购买者×4种使用者×6种动机的组合",
  "recommendations": [
    "针对礼品场景：优化产品包装和赠送体验，突出'安全'和'贴心'属性",
    "针对自用场景：优化产品功能和使用体验，突出'实用'和'便捷'属性",
    "在广告投放中，根据购买者身份匹配不同的决策路径话术"
  ],
  "severity": "info"
}
```

---

### 4.2 需求洞察模块

#### 2.1 刚需场景分析 (motivation_location)
**分析维度**：动机 × 地点（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "购买动机与使用地点的交叉关系"
- `business_value`: "识别高频高满意度场景，找到产品的'黄金使用场景'"
- `data_description`: "动机×地点热力图数据，显示每种动机-地点组合的出现频次"

**关键发现要求**：
- 识别高频的动机-地点组合（刚需场景）
- 发现不同动机对应的典型使用地点
- 识别"黄金场景"（高频+高满意度）

**示例输出**：
```json
{
  "keyFindings": [
    "核心刚需场景: 办公室 × 提升效率动机，出现32次，占比45.7%",
    "健康需求主要发生在'家庭'场景（18次），占比60%",
    "礼品场景主要发生在'线上购买'（12次），需要优化线上体验"
  ],
  "dataSupport": [
    {"metric": "动机类型数", "value": "5种"},
    {"metric": "地点类型数", "value": "6种"},
    {"metric": "总组合数", "value": "70次"}
  ],
  "recommendations": [
    "重点推广'办公室+提升效率'场景，这是产品的核心价值点",
    "针对健康需求，优化家庭使用场景的产品设计和营销",
    "优化线上购买流程和包装，提升礼品场景的用户体验"
  ],
  "severity": "success"
}
```

#### 2.2 需求满足度矩阵 (demand_satisfaction)
**分析维度**：动机 × 情感倾向（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "购买动机与用户满意度的匹配度"
- `business_value`: "识别'期望高但满意度低'的需求，用于差评预警"
- `data_description`: "动机×情感倾向矩阵，显示每种动机对应的正面/中性/负面评论数量"

**关键发现要求**：
- 识别满意度高的动机（期望匹配）
- 识别满意度低的动机（期望落差）
- 计算各动机的满意度指标

**示例输出**：
```json
{
  "keyFindings": [
    "'长续航'动机满意度最低（负面占比45%），需要重点关注",
    "'便携性'动机满意度最高（正面占比78%），是产品优势",
    "期望落差最大的动机是'长续航'和'快速充电'，负面占比均超过40%"
  ],
  "dataSupport": [
    {"metric": "总评论数", "value": "53条"},
    {"metric": "动机类型数", "value": "5种"},
    {"metric": "平均满意度", "value": "62%"}
  ],
  "recommendations": [
    "优先改进'长续航'和'快速充电'功能，这是用户的核心痛点",
    "在营销中谨慎承诺'长续航'，避免用户期望过高",
    "强化'便携性'优势，这是产品的差异化竞争力"
  ],
  "severity": "warning"
}
```

#### 2.3 心智匹配分析 (motivation_emotion)
**分析维度**：动机 × 用户情感（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "购买动机与用户情感的匹配度"
- `business_value`: "验证品牌定位，分析动机与情感的匹配度"
- `data_description`: "动机×情感热力图，显示每种动机对应的情感类型和频次"

**关键发现要求**：
- 识别动机与情感的匹配模式
- 发现"正向匹配"（动机与情感一致）和"负向匹配"（动机与情感冲突）
- 识别品牌定位的验证点

**示例输出**：
```json
{
  "keyFindings": [
    "追求'健康'的用户情感主要是'安心'（15次）和'满意'（8次），匹配度良好",
    "'性价比'动机对应的情感以'惊喜'（12次）为主，说明产品超预期",
    "'外观设计'动机对应的情感以'骄傲'（6次）为主，说明设计是品牌溢价点"
  ],
  "dataSupport": [
    {"metric": "动机类型数", "value": "5种"},
    {"metric": "情感类型数", "value": "8种"},
    {"metric": "总匹配次数", "value": "45次"}
  ],
  "recommendations": [
    "强化'健康+安心'的品牌定位，这是用户的核心心智",
    "在营销中突出'性价比+惊喜'的卖点，吸引价格敏感用户",
    "提升产品设计，强化'外观+骄傲'的品牌溢价能力"
  ],
  "severity": "success"
}
```

#### 2.4 研发优先级 (rnd_priority)
**分析维度**：动机 × 劣势 × 建议（3D交叉）

**Prompt定制点**：
- `focus_dimension`: "核心痛点识别（动机→劣势→建议的完整链条）"
- `business_value`: "核心痛点识别，用于PRD优先级排序"
- `data_description`: "3D矩阵数据，按动机分层，每层显示劣势×建议的热力图"

**关键发现要求**：
- 识别高频的动机-劣势-建议链条
- 发现核心痛点（高频动机+高频劣势+高频建议）
- 识别研发优先级（按影响范围和严重程度）

**示例输出**：
```json
{
  "keyFindings": [
    "核心痛点: 旅行刚需动机 → 续航问题（劣势）→ 增加电池容量（建议），出现18次",
    "办公场景的主要痛点是'静音不足'，建议'改进降噪技术'，出现12次",
    "健康需求的主要痛点是'功能单一'，建议'增加健康监测功能'，出现8次"
  ],
  "dataSupport": [
    {"metric": "动机类型数", "value": "5种"},
    {"metric": "劣势维度数", "value": "6种"},
    {"metric": "建议类型数", "value": "8种"},
    {"metric": "总链条数", "value": "45条"}
  ],
  "recommendations": [
    "优先级1: 改进电池续航（影响旅行场景，18次提及）",
    "优先级2: 优化降噪技术（影响办公场景，12次提及）",
    "优先级3: 增加健康监测功能（影响健康需求，8次提及）"
  ],
  "severity": "warning"
}
```

---

### 4.3 产品洞察模块

#### 3.1 致命缺陷识别 (critical_weakness)
**分析维度**：产品劣势 × 情感倾向（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "高负面情绪+高提及的致命缺陷"
- `business_value`: "识别'高负面情绪+高提及'的致命缺陷，用于改进优先级"
- `data_description`: "劣势×情感倾向矩阵，显示每种劣势对应的正面/中性/负面评论数量"

**关键发现要求**：
- 识别负面情绪占比高的劣势
- 发现提及频次高的劣势
- 识别"致命缺陷"（高负面+高提及）

**示例输出**：
```json
{
  "keyFindings": [
    "电池续航差的负面情绪占比最高（85%），出现24次，是致命缺陷",
    "结构做工问题的负面情绪占比78%，出现18次，需要优先改进",
    "设计外观的负面情绪占比最低（15%），说明设计是产品优势"
  ],
  "dataSupport": [
    {"metric": "总评论数", "value": "53条"},
    {"metric": "劣势维度数", "value": "6种"},
    {"metric": "平均负面占比", "value": "45%"}
  ],
  "recommendations": [
    "立即改进电池续航问题，这是用户最不满意的点（85%负面）",
    "优化结构做工，提升产品质量和耐用性",
    "保持设计优势，继续强化外观设计"
  ],
  "severity": "critical"
}
```

#### 3.2 优劣势对比 (strength_weakness)
**分析维度**：产品优势 × 产品劣势（2D对比）

**Prompt定制点**：
- `focus_dimension`: "各维度的优劣势对比"
- `business_value`: "识别'纯优势无劣势'的维度，用于差异化方向"
- `data_description`: "各维度的优势提及次数和劣势提及次数对比"

**关键发现要求**：
- 识别"纯优势"维度（只有优势没有劣势）
- 识别"纯劣势"维度（只有劣势没有优势）
- 识别"平衡维度"（优势劣势都有）

**示例输出**：
```json
{
  "keyFindings": [
    "设计维度100%正向评价（优势15次，劣势0次），是核心竞争力",
    "电池续航维度100%负向评价（优势0次，劣势24次），是核心痛点",
    "功能表现维度平衡（优势12次，劣势8次），需要持续优化"
  ],
  "dataSupport": [
    {"metric": "维度总数", "value": "8个"},
    {"metric": "纯优势维度", "value": "2个"},
    {"metric": "纯劣势维度", "value": "1个"}
  ],
  "recommendations": [
    "强化设计优势，在营销中突出设计差异化竞争力",
    "优先改进电池续航，这是用户最不满意的维度",
    "持续优化功能表现，保持优势并减少劣势"
  ],
  "severity": "info"
}
```

#### 3.3 优势情感分析 (strength_emotion)
**分析维度**：产品优势 × 用户情感（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "能触发强烈正面情感的优势维度"
- `business_value`: "识别能触发强烈正面情感的优势维度，用于品牌溢价点"
- `data_description`: "优势×情感热力图，显示每种优势对应的情感类型和频次"

**关键发现要求**：
- 识别触发强烈正面情感的优势
- 发现情感强度高的优势维度
- 识别品牌溢价点（优势+强烈正面情感）

**示例输出**：
```json
{
  "keyFindings": [
    "设计精美触发'骄傲'情感（8次）和'满足'情感（6次），情感强度高",
    "便携性触发'惊喜'情感（12次），说明超出用户预期",
    "功能强大触发'满意'情感（10次），是产品基础优势"
  ],
  "dataSupport": [
    {"metric": "优势维度数", "value": "6种"},
    {"metric": "情感类型数", "value": "8种"},
    {"metric": "总匹配次数", "value": "45次"}
  ],
  "recommendations": [
    "强化设计优势，这是品牌溢价的核心点（骄傲+满足情感）",
    "在营销中突出便携性的'惊喜'体验，吸引追求便捷的用户",
    "保持功能优势，这是产品的基础竞争力"
  ],
  "severity": "success"
}
```

#### 3.4 场景化改进建议 (improvement_priority)
**分析维度**：地点 × 产品改进建议（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "环境相关的硬件需求"
- `business_value`: "环境相关的硬件需求，用于PRD"
- `data_description`: "地点×建议热力图，显示每个使用地点对应的改进建议频次"

**关键发现要求**：
- 识别不同场景的改进需求差异
- 发现场景特定的改进建议
- 识别高频场景的改进优先级

**示例输出**：
```json
{
  "keyFindings": [
    "户外使用场景高频建议'防水'（12次），占比60%",
    "办公室场景高频建议'静音'（8次），占比40%",
    "家庭场景高频建议'易清洁'（6次），占比30%"
  ],
  "dataSupport": [
    {"metric": "地点类型数", "value": "6种"},
    {"metric": "建议类型数", "value": "8种"},
    {"metric": "总建议次数", "value": "35次"}
  ],
  "recommendations": [
    "开发'户外增强版'，增加防水功能（影响户外场景，12次提及）",
    "优化降噪技术，提升办公室使用体验（影响办公场景，8次提及）",
    "改进材质和表面处理，提升易清洁性（影响家庭场景，6次提及）"
  ],
  "severity": "info"
}
```

#### 3.5 动机分层优化 (motivation_suggestion)
**分析维度**：动机 × 产品改进建议（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "不同购买动机用户的改进诉求差异"
- `business_value`: "发现不同购买动机用户的改进诉求差异，用于用户分层策略"
- `data_description`: "动机×建议热力图，显示每种动机对应的改进建议频次"

**关键发现要求**：
- 识别不同动机的改进需求差异
- 发现动机特定的改进建议
- 识别用户分层策略

**示例输出**：
```json
{
  "keyFindings": [
    "追求性能的用户建议'提升配置'（10次），占比50%",
    "追求便携的用户建议'减轻重量'（8次），占比40%",
    "追求性价比的用户建议'降低价格'（6次），占比30%"
  ],
  "dataSupport": [
    {"metric": "动机类型数", "value": "5种"},
    {"metric": "建议类型数", "value": "8种"},
    {"metric": "总建议次数", "value": "35次"}
  ],
  "recommendations": [
    "针对性能用户：推出'高性能版'，提升配置和性能",
    "针对便携用户：推出'轻量版'，减轻重量和体积",
    "针对性价比用户：优化成本结构，提供更具竞争力的价格"
  ],
  "severity": "info"
}
```

#### 3.6 维度冲突分析 (negative_optimization)
**分析维度**：产品改进建议 × 优势维度（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "'优势被改进建议抵消'的维度"
- `business_value`: "识别'优势被改进建议抵消'的维度，用于迭代优先级"
- `data_description`: "各维度的优势提及次数和改进建议提及次数对比"

**关键发现要求**：
- 识别"冲突维度"（既有优势又有改进建议）
- 发现冲突率高的维度
- 识别需要平衡的维度

**示例输出**：
```json
{
  "keyFindings": [
    "设计维度冲突率最高（优势15次，建议8次），需要平衡美观和实用性",
    "功能维度冲突率中等（优势12次，建议6次），需要持续优化",
    "材质维度冲突率最低（优势8次，建议2次），相对稳定"
  ],
  "dataSupport": [
    {"metric": "维度总数", "value": "8个"},
    {"metric": "冲突维度数", "value": "5个"},
    {"metric": "平均冲突率", "value": "35%"}
  ],
  "recommendations": [
    "平衡设计维度的美观和实用性，避免过度设计",
    "持续优化功能维度，保持优势并减少改进需求",
    "保持材质优势，这是产品的稳定竞争力"
  ],
  "severity": "warning"
}
```

---

### 4.4 场景洞察模块

#### 4.1 地点×时间的完整交叉关系热力图 (scenario_distribution)
**分析维度**：地点 × 时间（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "高频使用时空的完整交叉关系"
- `business_value`: "识别高频使用时空的完整交叉关系，用于流量密码（投放时段）"
- `data_description`: "地点×时间热力图矩阵，显示每种地点-时间组合的出现频次"

**关键发现要求**：
- 识别高频的地点-时间组合
- 发现时空使用模式
- 识别最佳投放时段

**示例输出**：
```json
{
  "keyFindings": [
    "最高频组合: 晨跑场景 × 早晨6-8点，出现18次，占比34%",
    "办公场景集中在工作日9-18点，出现15次，占比28%",
    "家庭场景集中在晚上19-22点，出现12次，占比23%"
  ],
  "dataSupport": [
    {"metric": "地点类型数", "value": "6种"},
    {"metric": "时间类型数", "value": "5种"},
    {"metric": "总组合数", "value": "53次"}
  ],
  "recommendations": [
    "在早晨6-8点投放晨跑场景广告，这是最高频使用时段",
    "在工作日9-18点投放办公场景广告，覆盖办公人群",
    "在晚上19-22点投放家庭场景广告，覆盖家庭用户"
  ],
  "severity": "success"
}
```

#### 4.2 场景×情感的完整交叉关系热力图 (scenario_sentiment)
**分析维度**：场景 × 情感（2D交叉）

**Prompt定制点**：
- `focus_dimension`: "不同场景引发的情感反馈的完整交叉关系"
- `business_value`: "不同场景引发的情感反馈的完整交叉关系，用于视觉指南（品牌定调）"
- `data_description`: "场景×情感热力图矩阵，显示每种场景-情感组合的出现频次"

**关键发现要求**：
- 识别场景与情感的匹配模式
- 发现正向场景（高频+正面情感）和负向场景（高频+负面情感）
- 识别品牌定调方向

**示例输出**：
```json
{
  "keyFindings": [
    "办公场景情感以'专注'（12次）和'高效'（8次）为主，匹配度良好",
    "旅行场景情感以'自由'（10次）和'惊喜'（6次）为主，说明产品适合旅行",
    "家庭场景情感以'安心'（8次）和'满足'（6次）为主，说明产品适合家庭使用"
  ],
  "dataSupport": [
    {"metric": "场景类型数", "value": "6种"},
    {"metric": "情感类型数", "value": "8种"},
    {"metric": "总组合数", "value": "45次"}
  ],
  "recommendations": [
    "针对办公场景：视觉风格采用简约、专业的设计，突出'专注'和'高效'",
    "针对旅行场景：视觉风格采用活力、自由的设计，突出'自由'和'惊喜'",
    "针对家庭场景：视觉风格采用温馨、安心的设计，突出'安心'和'满足'"
  ],
  "severity": "success"
}
```

#### 4.3 真实生活瞬间 (life_moment)
**分析维度**：地点 × 时机 × 场景（3D交叉）

**Prompt定制点**：
- `focus_dimension`: "完整还原用户使用场景"
- `business_value`: "完整还原用户使用场景，用于产品定义(PD)"
- `data_description`: "3D矩阵数据，按地点分层，每层显示时机×场景的热力图"

**关键发现要求**：
- 识别主要的3D组合（地点×时机×场景）
- 发现真实生活瞬间
- 识别产品使用场景的完整画像

**示例输出**：
```json
{
  "keyFindings": [
    "最典型的真实生活瞬间: 健身房（地点）+ 晚上（时机）+ 力量训练（场景），出现12次",
    "办公场景主要集中在工作日9-18点，主要用于'提升效率'场景，出现15次",
    "家庭场景主要集中在晚上19-22点，主要用于'放松'场景，出现10次"
  ],
  "dataSupport": [
    {"metric": "地点类型数", "value": "6种"},
    {"metric": "时机类型数", "value": "5种"},
    {"metric": "场景类型数", "value": "8种"},
    {"metric": "总3D组合数", "value": "45次"}
  ],
  "recommendations": [
    "产品定义应聚焦'健身房+晚上+力量训练'场景，这是最典型的使用场景",
    "优化产品在办公场景的使用体验，这是高频使用场景",
    "提升产品在家庭场景的易用性，这是重要的使用场景"
  ],
  "severity": "info"
}
```

#### 4.4 环境冲突分析 (environment_conflict)
**分析维度**：情感 × 产品维度 × 地点（3D交叉）

**Prompt定制点**：
- `focus_dimension`: "特定环境下的产品问题"
- `business_value`: "识别特定环境下的产品问题，用于产品线扩张"
- `data_description`: "3D矩阵数据，按情感分层，每层显示产品维度×地点的热力图"

**关键发现要求**：
- 识别环境特定的产品问题
- 发现情感-维度-地点的冲突模式
- 识别产品线扩张机会

**示例输出**：
```json
{
  "keyFindings": [
    "失望情感 + 续航维度 + 户外场景，出现12次，说明户外场景续航不足",
    "焦虑情感 + 功能维度 + 办公场景，出现8次，说明办公场景功能不足",
    "满意情感 + 设计维度 + 家庭场景，出现15次，说明家庭场景设计优势明显"
  ],
  "dataSupport": [
    {"metric": "情感类型数", "value": "6种"},
    {"metric": "维度类型数", "value": "8种"},
    {"metric": "地点类型数", "value": "6种"},
    {"metric": "总3D组合数", "value": "45次"}
  ],
  "recommendations": [
    "推出'户外增强版'，增加电池容量和续航能力（解决户外场景续航问题）",
    "推出'办公专业版'，增加办公相关功能（解决办公场景功能不足）",
    "保持设计优势，继续强化家庭场景的产品设计"
  ],
  "severity": "warning"
}
```

---

### 4.5 品牌洞察模块

#### 5.1 品牌记忆点 (brand_memory)
**分析维度**：产品优势 × 场景 × 情感（3D交叉）

**Prompt定制点**：
- `focus_dimension`: "'优势+场景+正向情感'的强关联"
- `business_value`: "识别'优势+场景+正向情感'的强关联，用于A+脚本/主图视频"
- `data_description`: "3D矩阵数据，按产品优势分层，每层显示场景×情感的热力图"

**关键发现要求**：
- 识别优势-场景-情感的强关联
- 发现品牌记忆点（高频+正向情感）
- 识别A+内容素材方向

**示例输出**：
```json
{
  "keyFindings": [
    "品牌记忆点: 便携性（优势）+ 旅行场景 + 自由感（情感），出现15次，占比33%",
    "设计优势 + 家庭场景 + 骄傲情感，出现12次，占比27%",
    "功能优势 + 办公场景 + 高效情感，出现10次，占比22%"
  ],
  "dataSupport": [
    {"metric": "优势类型数", "value": "6种"},
    {"metric": "场景类型数", "value": "8种"},
    {"metric": "情感类型数", "value": "8种"},
    {"metric": "总3D组合数", "value": "45次"}
  ],
  "recommendations": [
    "A+脚本重点突出'便携性+旅行+自由感'的品牌记忆点",
    "主图视频展示'设计+家庭+骄傲'的使用场景",
    "营销内容强化'功能+办公+高效'的产品价值"
  ],
  "severity": "success"
}
```

#### 5.2 用户推荐意愿 (recommendation_willingness)
**分析维度**：评分 + 情感倾向（统计）

**Prompt定制点**：
- `focus_dimension`: "用户推荐意愿和口碑"
- `business_value`: "评估品牌口碑和NPS（净推荐值）"
- `data_description`: "评分分布、平均评分、推荐率、高参与度评论数据"

**关键发现要求**：
- 识别推荐意愿指标（4-5星占比）
- 发现高参与度评论特征
- 识别口碑优势和改进点

**示例输出**：
```json
{
  "keyFindings": [
    "推荐率85%，平均评分4.5分，口碑良好",
    "高参与度评论（有帮助投票）主要集中在5星评价，占比78%",
    "4-5星评价占比92%，说明产品整体满意度高"
  ],
  "dataSupport": [
    {"metric": "总评论数", "value": "53条"},
    {"metric": "平均评分", "value": "4.5分"},
    {"metric": "推荐率", "value": "85%"},
    {"metric": "高参与度评论数", "value": "12条"}
  ],
  "recommendations": [
    "保持产品质量和服务，维持高推荐率",
    "鼓励高满意度用户分享评价，提升口碑传播",
    "关注低评分评论，识别改进机会"
  ],
  "severity": "success"
}
```

#### 5.3 品牌核心心智 (brand_mind)
**分析维度**：产品优势统计（单维度）

**Prompt定制点**：
- `focus_dimension`: "用户心智中的核心优势维度"
- `business_value`: "识别用户心智中的核心优势维度"
- `data_description`: "各优势维度的提及次数排序"

**关键发现要求**：
- 识别提及率最高的优势维度
- 发现品牌核心心智
- 识别差异化竞争力

**示例输出**：
```json
{
  "keyFindings": [
    "'设计'维度提及率最高（24次，占比45%），是品牌核心心智",
    "'便携性'维度提及率第二（18次，占比34%），是差异化竞争力",
    "'功能'维度提及率第三（12次，占比23%），是产品基础优势"
  ],
  "dataSupport": [
    {"metric": "优势维度总数", "value": "6种"},
    {"metric": "总提及次数", "value": "53次"},
    {"metric": "平均提及次数", "value": "8.8次"}
  ],
  "recommendations": [
    "强化'设计'优势，这是品牌的核心心智和差异化竞争力",
    "在营销中突出'便携性'优势，吸引追求便捷的用户",
    "保持'功能'优势，这是产品的基础竞争力"
  ],
  "severity": "success"
}
```

---

## 五、Prompt生成函数设计

### 4.1 函数签名

```python
def generate_pivot_insight_prompt(
    analysis_name: str,
    analysis_description: str,
    business_value: str,
    focus_dimension: str,
    data: Dict[str, Any],
    data_description: str,
    module_type: str,  # '2d' or '3d'
    dimensions: List[str]  # 如 ['buyer', 'user'] 或 ['buyer', 'user', 'motivation']
) -> str:
    """生成标准化的数据透视AI prompt"""
    pass
```

### 4.2 实现逻辑

1. **选择基础模板**：根据 `module_type` 选择2D或3D模板
2. **填充定制内容**：根据子模块配置填充 `analysis_name`, `business_value` 等
3. **格式化数据**：将输入数据格式化为JSON字符串
4. **生成完整Prompt**：组合所有部分生成最终prompt

---

## 六、实施状态（2026-01-25更新）

### 5.1 ✅ 第一阶段：基础模板实现（已完成）
1. ✅ 实现了3种prompt模板（2D、3D、统计）
2. ✅ 实现了 `generate_pivot_insight_prompt` 函数
3. ✅ 为所有20个AI解读子模块创建了配置字典

### 5.2 ✅ 第二阶段：分析方法实现（已完成）
1. ✅ 实现了所有20个分析方法
2. ✅ 数据格式与前端 `dataCalculator.ts` 完全对齐
3. ✅ 正确区分了 `review_theme_highlights` 和 `review_insights` 两个表

### 5.3 第三阶段：测试和优化（进行中）
1. ⏳ 测试所有20个AI解读子模块的prompt
2. ⏳ 验证输出格式的一致性
3. ⏳ 根据实际输出效果优化prompt
4. ⏳ 收集用户反馈并迭代

---

## 六、前端模块与后端AI解读映射表

| 前端模块 | 前端标题 | AI解读类型 | Prompt配置 | 分析方法 | 数据来源表 |
|---------|---------|-----------|-----------|---------|-----------|
| 1.1 | 决策链路分析 | `decision_flow` | ✅ | ✅ | theme_highlights |
| 1.2 | 人群-卖点匹配分析 | `audience_strength` | ✅ | ✅ | theme_highlights + insights |
| 1.3 | 决策逻辑链 | `decision_logic_chain` | ✅ | ✅ | theme_highlights (3D) |
| 2.1 | 刚需场景分析 | `motivation_location` | ✅ | ✅ | theme_highlights |
| 2.2 | 需求满足度矩阵 | `demand_satisfaction` | ✅ | ✅ | theme_highlights + reviews |
| 2.3 | 心智匹配分析 | `motivation_emotion` | ✅ | ✅ | theme_highlights + insights |
| 2.4 | 研发优先级 | `rnd_priority` | ✅ | ✅ | theme_highlights + insights (3D) |
| 3.1 | 致命缺陷识别 | `critical_weakness` | ✅ | ✅ | insights + reviews |
| 3.2 | 优劣势对比 | `strength_weakness` | ✅ | ✅ | insights |
| 3.3 | 优势情感分析 | `strength_emotion` | ✅ | ✅ | insights |
| 3.4 | 场景化改进建议 | `improvement_priority` | ✅ | ✅ | theme_highlights + insights |
| 3.5 | 动机分层优化 | `motivation_suggestion` | ✅ | ✅ | theme_highlights + insights |
| 3.6 | 维度冲突分析 | `negative_optimization` | ✅ | ✅ | insights |
| 4.1 | 地点×时间热力图 | `scenario_distribution` | ✅ | ✅ | theme_highlights |
| 4.2 | 场景×情感热力图 | `scenario_sentiment` | ✅ | ✅ | insights |
| 4.3 | 真实生活瞬间 | `life_moment` | ✅ | ✅ | theme_highlights + insights (3D) |
| 4.4 | 环境冲突分析 | `environment_conflict` | ✅ | ✅ | insights + theme_highlights (3D) |
| 5.1 | 品牌记忆点 | `brand_memory` | ✅ | ✅ | insights (3D) |
| 5.2 | 用户推荐意愿 | `recommendation_willingness` | ✅ | ✅ | reviews |
| 5.3 | 品牌核心心智 | `brand_mind` | ✅ | ✅ | insights |

**说明**:
- ✅ = 已完成
- ⏳ = 进行中
- 概览模块（1.0, 2.0, 3.0, 4.0, 5.0）使用内联生成，不需要后端AI解读

---

**文档版本**：v1.1  
**创建时间**：2026-01-25  
**最后更新**：2026-01-25
